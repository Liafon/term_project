food_database = {
    "燕麥": {"calories": 3.7, "protein": 0.12, "fat": 0.07, "carbs": 0.6, "sugar": 0.01, "vitamin_c": 0.0},
    "雞胸肉": {"calories": 2.2, "protein": 0.32, "fat": 0.07, "carbs": 0.0, "sugar": 0.0, "vitamin_c": 0.0},
    "沙拉": {"calories": 1.0, "protein": 0.03, "fat": 0.05, "carbs": 0.20, "sugar": 0.05, "vitamin_c": 0.05},
    "蘋果": {"calories": 0.95, "protein": 0.005, "fat": 0.003, "carbs": 0.25, "sugar": 0.2, "vitamin_c": 0.46},
    "香蕉": {"calories": 1.05, "protein": 0.013, "fat": 0.003, "carbs": 0.027, "sugar": 0.12, "vitamin_c": 0.087},
    "牛肉": {"calories": 2.5, "protein": 0.26, "fat": 0.15, "carbs": 0.0, "sugar": 0.0, "vitamin_c": 0.0},
    "米飯": {"calories": 2.0, "protein": 0.04, "fat": 0.005, "carbs": 0.45, "sugar": 0.02, "vitamin_c": 0.0},
    "蛋": {"calories": 0.68, "protein": 0.06, "fat": 0.05, "carbs": 0.01, "sugar": 0.01, "vitamin_c": 0.0},
    "西蘭花": {"calories": 0.34, "protein": 0.03, "fat": 0.01, "carbs": 0.07, "sugar": 0.02, "vitamin_c": 0.89},
    "胡蘿蔔": {"calories": 0.41, "protein": 0.01, "fat": 0.02, "carbs": 0.1, "sugar": 0.05, "vitamin_c": 0.076},
    "番茄": {"calories": 0.18, "protein": 0.009, "fat": 0.002, "carbs": 0.039, "sugar": 0.02, "vitamin_c": 0.13},
    "牛奶": {"calories": 0.42, "protein": 0.03, "fat": 0.02, "carbs": 0.05, "sugar": 0.05, "vitamin_c": 0.0},
    "豆腐": {"calories": 1.2, "protein": 0.12, "fat": 0.07, "carbs": 0.02, "sugar": 0.01, "vitamin_c": 0.0},
    "鯖魚": {"calories": 2.2, "protein": 0.25, "fat": 0.12, "carbs": 0.0, "sugar": 0.0, "vitamin_c": 0.0},
    "橙子": {"calories": 0.47, "protein": 0.009, "fat": 0.001, "carbs": 0.12, "sugar": 0.09, "vitamin_c": 0.53},
    "葡萄": {"calories": 0.69, "protein": 0.007, "fat": 0.001, "carbs": 0.18, "sugar": 0.16, "vitamin_c": 0.045},
    "雞蛋白": {"calories": 0.17, "protein": 0.04, "fat": 0.0, "carbs": 0.01, "sugar": 0.0, "vitamin_c": 0.0},
    "花生": {"calories": 0.567, "protein": 0.25, "fat": 0.49, "carbs": 0.16, "sugar": 0.03, "vitamin_c": 0.0},
    "堅果混合": {"calories": 6.0, "protein": 0.15, "fat": 0.55, "carbs": 0.20, "sugar": 0.05, "vitamin_c": 0.0},
    "牛肉漢堡肉": {"calories": 2.8, "protein": 0.26, "fat": 0.22, "carbs": 0.0, "sugar": 0.0, "vitamin_c": 0.0},
    "全麥麵包": {"calories": 2.5, "protein": 0.09, "fat": 0.04, "carbs": 0.43, "sugar": 0.05, "vitamin_c": 0.0},
    "白麵包": {"calories": 2.7, "protein": 0.08, "fat": 0.03, "carbs": 0.49, "sugar": 0.07, "vitamin_c": 0.0},
    "綠豆湯": {"calories": 0.78, "protein": 0.04, "fat": 0.01, "carbs": 0.14, "sugar": 0.06, "vitamin_c": 0.0},
    "炸雞": {"calories": 3.0, "protein": 0.25, "fat": 0.22, "carbs": 0.15, "sugar": 0.02, "vitamin_c": 0.0},
    "蘋果派": {"calories": 2.9, "protein": 0.02, "fat": 0.15, "carbs": 0.45, "sugar": 0.30, "vitamin_c": 0.0},
    "巧克力": {"calories": 5.4, "protein": 0.05, "fat": 0.32, "carbs": 0.56, "sugar": 0.5, "vitamin_c": 0.0},
    "藍莓": {"calories": 0.57, "protein": 0.01, "fat": 0.003, "carbs": 0.14, "sugar": 0.09, "vitamin_c": 0.09},
    "柚子": {"calories": 0.42, "protein": 0.008, "fat": 0.002, "carbs": 0.11, "sugar": 0.07, "vitamin_c": 0.052},
    "石榴": {"calories": 0.83, "protein": 0.016, "fat": 0.003, "carbs": 0.22, "sugar": 0.17, "vitamin_c": 0.1},
    "蘆筍": {"calories": 0.2, "protein": 0.02, "fat": 0.02, "carbs": 0.04, "sugar": 0.01, "vitamin_c": 0.14},
    "紅椒": {"calories": 0.31, "protein": 0.01, "fat": 0.01, "carbs": 0.07, "sugar": 0.04, "vitamin_c": 1.5},
    "馬鈴薯": {"calories": 0.77, "protein": 0.02, "fat": 0.01, "carbs": 0.17, "sugar": 0.01, "vitamin_c": 0.01},
    "菠蘿蜜": {"calories": 0.95, "protein": 0.02, "fat": 0.03, "carbs": 0.24, "sugar": 0.18, "vitamin_c": 0.12},
    "蕃茄醬": {"calories": 1.2, "protein": 0.01, "fat": 0.01, "carbs": 0.28, "sugar": 0.15, "vitamin_c": 0.12},
    "椰漿": {"calories": 0.7, "protein": 0.02, "fat": 0.07, "carbs": 0.02, "sugar": 0.01, "vitamin_c": 0.0},
    "杏仁": {"calories": 5.7, "protein": 0.21, "fat": 0.49, "carbs": 0.2, "sugar": 0.02, "vitamin_c": 0.0},
    "牛油果": {"calories": 1.6, "protein": 0.02, "fat": 0.15, "carbs": 0.09, "sugar": 0.02, "vitamin_c": 0.1},
    "奇異果": {"calories": 0.61, "protein": 0.01, "fat": 0.03, "carbs": 0.15, "sugar": 0.09, "vitamin_c": 0.92},
    "柿子": {"calories": 0.81, "protein": 0.004, "fat": 0.003, "carbs": 0.22, "sugar": 0.14, "vitamin_c": 0.21},
    "綠茶": {"calories": 0.1, "protein": 0.0, "fat": 0.0, "carbs": 0.02, "sugar": 0.0, "vitamin_c": 0.05},
    "胡椒": {"calories": 1.1, "protein": 0.03, "fat": 0.03, "carbs": 0.24, "sugar": 0.03, "vitamin_c": 0.16},
    "橄欖": {"calories": 1.45, "protein": 0.01, "fat": 0.14, "carbs": 0.04, "sugar": 0.02, "vitamin_c": 0.0},
    "花椰菜": {"calories": 0.34, "protein": 0.03, "fat": 0.01, "carbs": 0.07, "sugar": 0.02, "vitamin_c": 0.89},
    "豆芽": {"calories": 0.29, "protein": 0.03, "fat": 0.01, "carbs": 0.06, "sugar": 0.01, "vitamin_c": 0.2},
    "菠菜": {"calories": 0.23, "protein": 0.02, "fat": 0.004, "carbs": 0.04, "sugar": 0.01, "vitamin_c": 0.28},
    "蕎麥": {"calories": 3.4, "protein": 0.13, "fat": 0.02, "carbs": 0.70, "sugar": 0.05, "vitamin_c": 0.0},
    "南瓜": {"calories": 0.25, "protein": 0.01, "fat": 0.01, "carbs": 0.06, "sugar": 0.03, "vitamin_c": 0.06},
    "紅薯": {"calories": 0.86, "protein": 0.02, "fat": 0.01, "carbs": 0.21, "sugar": 0.05, "vitamin_c": 0.2},
    "燕麥片": {"calories": 3.0, "protein": 0.12, "fat": 0.06, "carbs": 0.56, "sugar": 0.01, "vitamin_c": 0.0},
    "黑豆": {"calories": 3.4, "protein": 0.23, "fat": 0.02, "carbs": 0.62, "sugar": 0.02, "vitamin_c": 0.0},
    "鷹嘴豆": {"calories": 3.0, "protein": 0.19, "fat": 0.03, "carbs": 0.56, "sugar": 0.03, "vitamin_c": 0.0}
}

class User:
    def __init__(self, name, age, weight, height, activity_level, gender):
        self.name = name
        self.age = int(age)  
        self.weight = float(weight)  
        self.height = int(height)  
        self.activity_level = activity_level
        self.gender = gender.lower()  
        self.daily_food_log = []  
        self.daily_calories = 0  
        self.daily_sugar = 0  
        self.daily_vitamin_c = 0  
        self.bmr = self.calculate_bmr()  
        self.tdee = self.calculate_tdee()  

    def calculate_bmr(self):
        if self.age < 18:
            raise ValueError("年齡不能小於18歲")
        if self.height <= 0 or self.weight <= 0:
            raise ValueError("身高或體重無效")
        if self.gender == 'female':
            bmr = 9.6 * self.weight + 1.8 * self.height - 4.7 * self.age + 655
        else:
            bmr = 13.7 * self.weight + 5 * self.height - 6.8 * self.age + 66 
        return bmr

    def calculate_tdee(self):
        activity_factor = {
            'sedentary': 1.2,  
            'light': 1.375,    
            'moderate': 1.55,  
            'active': 1.725,   
            'very_active': 1.9  
        }
        if self.activity_level not in activity_factor:
            raise ValueError("無效的活動等級")
        return self.bmr * activity_factor[self.activity_level]

    def log_food(self, food_name, grams=1):
        if food_name not in food_database:
            print(f"食物 '{food_name}' 不在資料庫中！")
            return
        food_data = food_database[food_name]
        calories = food_data["calories"] * grams
        protein = food_data["protein"] * grams
        fat = food_data["fat"] * grams
        carbs = food_data["carbs"] * grams
        sugar = food_data["sugar"] * grams
        vitamin_c = food_data.get("vitamin_c", 0) * grams  

        food_entry = {
            'name': food_name,
            'grams': grams,
            'calories': calories,
            'protein': protein,
            'fat': fat,
            'carbs': carbs,
            'sugar': sugar,
            'vitamin_c': vitamin_c
        }
        self.daily_food_log.append(food_entry)
        self.daily_calories += calories
        self.daily_sugar += sugar
        self.daily_vitamin_c += vitamin_c

    def get_daily_nutrition(self):
        total_protein = sum([food['protein'] for food in self.daily_food_log])
        total_fat = sum([food['fat'] for food in self.daily_food_log])
        total_carbs = sum([food['carbs'] for food in self.daily_food_log])
        total_sugar = sum([food['sugar'] for food in self.daily_food_log])
        total_vitamin_c = sum([food['vitamin_c'] for food in self.daily_food_log])
        return total_protein, total_fat, total_carbs, total_sugar, total_vitamin_c

    def give_diet_advice(self):
        print("今日飲食建議:")
        print(f"基礎代謝率 (BMR): {self.bmr:.2f} 大卡")
        print(f"總日常能量消耗 (TDEE): {self.tdee:.2f} 大卡")
        print(f"今日總攝取卡路里: {self.daily_calories:.2f} 大卡 (建議攝取量: {self.get_calories_recommendation()})")
        print(f"今日總攝取糖分: {self.daily_sugar:.2f} 克 (建議攝取量: {self.get_sugar_recommendation()} 克)")
        print(f"今日總攝取維生素C: {self.daily_vitamin_c:.2f} 毫克 (建議攝取量: 65-90 毫克)")
        
        if self.daily_calories > self.tdee:
            print("警告：您今天攝取的卡路里過高，應減少高熱量食物的攝取。")
        elif self.daily_calories < self.tdee:
            print("建議：您今天攝取的卡路里不足，應增加攝取量以達到每日所需。")
        else:
            print("您今天的卡路里攝取量正好，保持這樣的飲食。")
        
        if self.daily_sugar > self.get_sugar_recommendation:
            print("警告：您的糖分攝取過高，應限制糖分的攝取，尤其是來自加工食品的糖。")
        else:
            print("您的糖分攝取在建議範圍內，繼續保持健康飲食。")
        
        if self.daily_vitamin_c < 65:
            print("警告：您今天的維生素C攝取不足，應增加含維生素C豐富的食物攝取。")
        elif self.daily_vitamin_c > 90:
            print("建議：您的維生素C攝取較高，可以減少攝取量來達到建議範圍。")
        else:
            print("您的維生素C攝取量在健康範圍內，繼續保持。")

    def get_sugar_recommendation(self):
        if self.activity_level == 'sedentary':
            return 25
        elif self.activity_level == 'light':
            return 30
        elif self.activity_level == 'moderate':
            return 35
        elif self.activity_level == 'active':
            return 40
        elif self.activity_level == 'very_active':
            return 45
            
if __name__ == "__main__":
    name = input('請輸入姓名：')
    age = input('請輸入年齡：')
    weight = input('請輸入體重(kg)：')
    height = input('請輸入身高(cm)：')
    activity_level = input('請輸入活動量(sedentary, light, moderate, active, very_active)：')
    gender = input('請輸入性別(male,female)')
    user = User(name, age, weight, height, activity_level,gender)

    print("目前資料庫中的食物有：", end=" ")
    for food in food_database.keys():
        print(food, end=", ")
    print()

    while True:
        food_name = input("\n請輸入食物名稱（輸入'quit'結束）：")
        if food_name.lower() == 'quit':
            break
        grams = float(input(f"請輸入 {food_name} 的攝取量 (單位：克)："))
        user.log_food(food_name, grams)

    user.give_diet_advice()

